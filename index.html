<html>

<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.js">
  </script>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js">
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/js/bootstrap-multiselect.js">
  </script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/css/bootstrap-multiselect.css"
    rel="stylesheet">
  <link rel="stylesheet" href="https://code.highcharts.com/css/highcharts.css">
  <link rel="stylesheet" href="combo.css">
  <script src="comboTreePlugin.js"></script>
  <link href="https://www.jqueryscript.net/css/jquerysctipttop.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.materialdesignicons.com/5.0.45/css/materialdesignicons.min.css">
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.6.1/nouislider.min.js"
    integrity="sha512-1mDhG//LAjM3pLXCJyaA+4c+h5qmMoTc7IuJyuNNPaakrWT9rVTxICK4tIizf7YwJsXgDC2JP74PGCc7qxLAHw=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.6.1/nouislider.css"
    integrity="sha512-MKxcSu/LDtbIYHBNAWUQwfB3iVoG9xeMCm32QV5hZ/9lFaQZJVaXfz9aFa0IZExWzCpm7OWvp9zq9gVip/nLMg=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
  <br>
  <div class="main-container">
    <div class="container">
      <b>Select Countries:</b>
      <input type="text" id="countries" placeholder="Select Counties" />
    </div>
    <div class="container">
      <b>Select Items:</b>
      <input style="width: 450px;" type="text" id="itemSelect" placeholder="Select items" autocomplete="off" />
    </div>
  </div>
  <div class="chart-container">
    <main id="chart"></main>
    <div class="legend">
      <ul id="legend1"></ul>
      <ul id="legend2"></ul>
    </div>
  </div>
  <div id="slider"></div>
  <script nomodule>
    //For old browsers not supporting ES modules
    window.alert("Sorry, your browser does not support ECMAScript modules!");
  </script>
  <script src="https://code.highcharts.com/highcharts.js"></script>
  <script src="https://cdn.jsdelivr.net/combine/npm/jsonstat-toolkit@1.3.2,npm/jsonstat-euro@1.1.2"></script>
  <script>
    function updateRange(chart, seriesData) {
      let monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
      let dateNumbers = seriesList[0].data.map(x => x[0])

      let slider = document.getElementById('slider');
      noUiSlider.create(slider, {
        start: [Math.min(...dateNumbers), Math.max(...dateNumbers)],
        connect: true,
        tooltips: true,
        step: 2592000,
        range: {
          'min': Math.min(...dateNumbers),
          'max': Math.max(...dateNumbers)
        }
      });
      slider.noUiSlider.on('update', function (values, handle) {
        $('.noUi-tooltip').eq(0).text(
          monthNames[new Date(Number(values[0])).getMonth()]
          + ' '
          + new Date(Number(values[0])).getFullYear()
        )
        $('.noUi-tooltip').eq(1).text(
          monthNames[new Date(Number(values[1])).getMonth()]
          + ' '
          + new Date(Number(values[1])).getFullYear()
        )
        let newSeries = JSON.parse(JSON.stringify(seriesData))
        for (let idx in newSeries) {
          chart.series[idx].update({
            data: newSeries[idx].data.filter(x => x[0] >= Number(values[0]) && x[0] <= Number(values[1]))
          })
        }
      });
    }
    $('#slider').width(
      $('#chart').width() - 65
    )
    addEventListener('resize', (event) => {
      $('#slider').width(
        $('#chart').width() - 65
      )
    });
  </script>
  <script src="customChart.js"></script>
  <script src="index.js"></script>

</body>

</html>